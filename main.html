<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crypto Simulator</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { font-family: Arial, sans-serif; background: #121212; color: #fff; padding: 20px; }
  h1 { text-align: center; }
  #wallet, #portfolio, #actions { margin: 20px 0; }
  button { padding: 10px; margin: 5px; cursor: pointer; }
  input { width: 60px; padding: 5px; }
  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  th, td { border: 1px solid #444; padding: 8px; text-align: center; }
  th { background: #222; }
</style>
</head>
<body>

<h1>Crypto Simulator</h1>

<div id="wallet">
  <strong>Wallet Balance:</strong> <span id="balance">1000</span> CoinX
</div>

<div id="portfolio">
  <h3>Portfolio</h3>
  <table>
    <thead>
      <tr>
        <th>Coin</th>
        <th>Amount</th>
        <th>Value</th>
        <th>Profit/Loss</th>
      </tr>
    </thead>
    <tbody id="portfolio-body"></tbody>
  </table>
</div>

<div id="actions">
  <input type="number" id="amount" placeholder="Amount" min="1">
  <button onclick="buyCoin()">Buy</button>
  <button onclick="sellCoin()">Sell</button>
</div>

<canvas id="priceChart" height="100"></canvas>

<script>
let balance = parseFloat(localStorage.getItem('balance')) || 1000;
let portfolio = JSON.parse(localStorage.getItem('portfolio')) || { CoinX: 0 };
let priceHistory = JSON.parse(localStorage.getItem('priceHistory')) || [];
let currentPrice = 100;

// Update UI
function updateUI() {
  document.getElementById('balance').innerText = balance.toFixed(2);
  const tbody = document.getElementById('portfolio-body');
  tbody.innerHTML = '';
  for (let coin in portfolio) {
    let value = portfolio[coin] * currentPrice;
    let profit = value - (portfolio[coin] * 100); // assuming starting buy price = 100
    tbody.innerHTML += `<tr>
      <td>${coin}</td>
      <td>${portfolio[coin]}</td>
      <td>${value.toFixed(2)}</td>
      <td style="color:${profit>=0?'lightgreen':'red'}">${profit.toFixed(2)}</td>
    </tr>`;
  }
}

// Buy coin
function buyCoin() {
  const amount = parseFloat(document.getElementById('amount').value);
  if (amount > 0 && balance >= amount * currentPrice) {
    balance -= amount * currentPrice;
    portfolio.CoinX += amount;
    saveGame();
    updateUI();
  } else alert('Not enough balance or invalid amount');
}

// Sell coin
function sellCoin() {
  const amount = parseFloat(document.getElementById('amount').value);
  if (amount > 0 && portfolio.CoinX >= amount) {
    balance += amount * currentPrice;
    portfolio.CoinX -= amount;
    saveGame();
    updateUI();
  } else alert('Not enough coins or invalid amount');
}

// Save game
function saveGame() {
  localStorage.setItem('balance', balance);
  localStorage.setItem('portfolio', JSON.stringify(portfolio));
  localStorage.setItem('priceHistory', JSON.stringify(priceHistory));
}

// Simulate price
function simulatePrice() {
  let change = (Math.random() - 0.5) * 5; // random fluctuation
  currentPrice = Math.max(1, currentPrice + change);
  priceHistory.push(currentPrice);
  if (priceHistory.length > 50) priceHistory.shift();
  chart.data.labels = priceHistory.map((_, i) => i);
  chart.data.datasets[0].data = priceHistory;
  chart.update();
  updateUI();
}

// Chart
const ctx = document.getElementById('priceChart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: priceHistory.map((_, i) => i),
    datasets: [{
      label: 'CoinX Price',
      data: priceHistory,
      borderColor: 'lime',
      backgroundColor: 'rgba(0,255,0,0.1)',
      fill: true,
      tension: 0.2
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { display: false } },
    scales: { y: { beginAtZero: false } }
  }
});

// Start simulation
updateUI();
setInterval(simulatePrice, 1000);
</script>

</body>
</html>
